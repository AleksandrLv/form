(function(){window.app=window.app||{},function(){app.Statement=Backbone.Model.extend({defaults:{name:"",faculty:"",course:"",statement:"",date:""},initialize:function(){var t;t=JSON.parse(localStorage.getItem("statement")),this.set(t)},validate:function(t,e){var i;return i=[],this.checkRusText(t.name)||i.push({field:"name",message:"Имя русскими буквами в родительном падеже."}),this.checkRusText(t.faculty)||i.push({field:"faculty",message:"Факультет русскими буквами в родительном падеже."}),this.checkCourse(t.course)||i.push({field:"course",message:"Цифра от 1 до 6."}),this.checkDate(t.date)||i.push({field:"date",message:"Дата введена неверно. Введите дату в формате ДД.ММ.ГГГГ."}),i.length>0?i:!1},checkRusText:function(t){var e;return e=/^[а-яА-Я ]+$/,e.test(t)},checkCourse:function(t){var e;return e=/^[1-6]$/,e.test(t)},checkDate:function(t){var e;return e=/(0[1-9]|1[0-9]|2[0-9]|3[01]).(0[1-9]|1[012]).[0-9]{4}$/,e.test(t)}})}()}).call(this),function(){window.app=window.app||{},function(){app.FormView=Backbone.View.extend({tagName:"form",el:"form",initialize:function(){this.fields={name:this.$("#in-name"),faculty:this.$("#in-faculty"),course:this.$("#in-course"),statement:this.$("#in-statement"),date:this.$("#in-date")},this.listenTo(this.model,"invalid",this.showErrors),this.listenTo(this.model,"change",this.saveLocalStorage),this.render()},events:{"click #save":"saveData"},render:function(){_.each(this.fields,function(t,e){t.val(this.model.attributes[e])},this)},edit:function(t){var e,i,s;s=t.target.value.trim(),e=t.target.id.split("-")[1],i={},i[e]=s,this.model.set(i,{validate:!0,field:e})},saveData:function(){var t;this.hideErrors(),t={},_.each(this.fields,function(e,i){t[i]=e.val()}),this.model.set(t,{validate:!0})},saveLocalStorage:function(){localStorage.setItem("statement",JSON.stringify(this.model.attributes))},showErrors:function(t,e){_.each(e,function(t){var e;e=this.fields[t.field],e.addClass("error"),e.next(".help-inline").text(t.message)},this)},hideErrors:function(){this.$("input").removeClass("error"),this.$("textarea").removeClass("error"),this.$(".help-inline").text("")}})}()}.call(this),function(){window.app=window.app||{},function(){app.StatementView=Backbone.View.extend({el:".document",initialize:function(){this.fields={name:this.$("#out-name"),faculty:this.$("#out-faculty"),course:this.$("#out-course"),statement:this.$("#out-statement"),date:this.$("#out-date")},this.listenTo(this.model,"change",this.updateDocument),this.render()},render:function(){return this.fields.name.html(this.model.get("name")),this.fields.faculty.html(this.model.get("faculty")),this.fields.course.html(this.model.get("course")),this.fields.statement.html(this.model.get("statement")),this.fields.date.html(this.model.get("date")),this},updateDocument:function(){_.each(this.model.changedAttributes(),function(t,e){this.fields[e].html(t)},this)}})}()}.call(this),function(){window.app=window.app||{},$(function(){var t;t=new app.Statement,new app.FormView({model:t}),new app.StatementView({model:t})})}.call(this);